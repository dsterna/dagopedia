{"version":3,"sources":["marker-filled.png","WikipediaLogo.svg","containers/headingMenu.js","index.js"],"names":["module","exports","__webpack_require__","p","options","code","text","speachCode","startText","StyledModal","Modal","styled","_templateObject","props","opacity","HeadingMenu","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","isOpen","language","sound","toggleModal","bind","assertThisInitialized","toggleSound","afterOpen","beforeClose","onSelectChanged","e","find","y","value","setState","onChange","_this2","setTimeout","_this3","Promise","resolve","react_default","a","createElement","className","onBackgroundClick","onEscapeKeydown","backgroundProps","style","cursor","onClick","role","aria-label","dist_default","map","Component","defaultLocation","lat","lng","markerIcon","L","icon","iconUrl","iconMarker","iconSize","iconAnchor","popupAnchor","App","updateMarker","data","mapComp","mapRef","current","marker","lon","header","title","wikiURL","pageid","leafletElement","flyToBounds","position","padding","animate","duration","fetch","then","response","json","datas","window","responsiveVoice","speak","query","pages","extract","wikiText","url","fullurl","createRef","zoom","started","haveUserPosition","visitedPageIds","wikiFetch","goBack","updatePosition","navigator","geolocation","watchPosition","coords","latitude","longitude","cancel","limitString","length","coordStrig","URL","visitedIndexes","i","geosearch","j","push","closesPage","includes","undefined","concat","toConsumableArray","tempAry","slice","build","headingMenu","ref","Map","center","zoomControl","minZoom","maxZoom","zoomSnap","id","accessToken","TileLayer","Marker","Popup","href","textAlign","paddingBottom","marginTop","rel","target","width","height","src","wikiLogo","alt","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.3bf426e8.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAABmJLR0QA/wD/AP+gvaeTAAACtElEQVRogeWazYuNURzHPzNoyCWJxmSKRAnlWelaWthosLOh/ANWLCw1kyZbbrqGBVsbJVlIibxLpCzIQiQ1eRu5V/cyXhbnPN1x5758z3PPOU/41K+m7u/5nu93nuc559znufCP0OdZbxEwAmwDEmA1sMR+NgW8BJ4A14DLwBfP4/fMEFAGqsAvsarAGWBtDn5nMQCMARX0AM31DThmtXJhGXCjg0HXugOsiJoA2AS87tF4q3pltaMwGCjEzDCDoUPMx1wCoUKkdZvA98xYhBBpjYcKMURvs5Nr1YE1IYKUI4ZIa8J3iAJmFY4dpGLH7kq/GGSnKmipAyeAoj2uYP8u2c9UFgI7HPq7chr9v/gG2NxBK7E9qt4pn0EeiIPWuoRISWyvonnPYw7eiYMed9AsiZqTXhJY6uKgWxw0i6JmzUsCi3oZuEwIBVHzqyKmzlpTDgZVvI6tin0S+zaIfS69H5UmNcgLsW+f2AewV+x77qDZlXH0GzMR9BL0CWTUYw72iIOmC2KnMK4L4i6fQZYDPxwGr2PWiZlblK00tiiqzndgsc8gAI8dDPiqm6o59WYHuOTQ64uLIUTXE/ds/ARWhQgC8ChikOsuxlwuLTBPBmNRDilewGwZQp+Nt8A8F2OuZ6QCnHU8JgsnMVNvUIbRd8NZ6jONJ/gyrmcEzKp8LsNxKiXC7LZbspIwz7g+AEtjhUgZ9WC8uQ5ETWBZgN+H2c9wnKl8sl8wqNZIZO9/0A88bGHKta7GNt6KBPP6LGuIKrAuuus2qN8gW9XBHPy2ZQB4inuI+8CcHPx2pAhMo4eoARtzcSpwFD3IoZw8SswFbtE9xBWybY+iMgy8p32IScxrvL+C3Zivqs0hpoHtOfrKxBFmBzmcq6OM9AHnaYS4gP9fI0WjgHnjdBe3Vw7/L78ByP0EVSkVHdcAAAAASUVORK5CYII=\"","module.exports = __webpack_public_path__ + \"static/media/WikipediaLogo.0df50668.svg\";","import 'react-dropdown/style.css'\nimport '../index.scss'\n\nimport React, { Component } from 'react';\n\nimport Dropdown from 'react-dropdown'\nimport Modal from \"styled-react-modal\";\n\nconst options = [\n    { code: \"sv\", text: 'Svenska ðŸ‡¸ðŸ‡ª', speachCode: \"Swedish Male\", startText: \"Starta\" },\n    { code: \"en\", text: 'English ðŸ‡¬ðŸ‡§', speachCode: \"UK English Male\", startText: \"Begin\" },\n    { code: \"fi\", text: 'Soumi ðŸ‡«ðŸ‡®', speachCode: \"Finnish Male\", startText: \"Alkaa\" },\n    { code: \"fr\", text: \"FranÃ§ais ðŸ‡«ðŸ‡·\", speachCode: \"French Female\", startText: \"DÃ©but\" },\n    { code: \"es\", text: \"EspaÃ±ol ðŸ‡ªðŸ‡¸\", speachCode: \"Spanish Male\", startText: \"Comienzo\" },\n    { code: \"da\", text: \"Dansk ðŸ‡©ðŸ‡°\", speachCode: \"Danish Male\", startText: \"Start\" },\n    { code: \"de\", text: \"Deutsch ðŸ‡©ðŸ‡ª\", speachCode: \"Deutsch Male\", startText: \"Starten\" }\n];\n\nconst StyledModal = Modal.styled`\n  text-align: left;\n  z-index:2;\n  width: 20rem;\n  height: 11rem;\n  border-radius: 20px;\n  padding: 40px;   \n  background-color: white;\n  opacity: ${props => props.opacity};\n  transition: opacity ease 500ms;\n  font-size:120%;\n  line-height: 26pt;\n  @media (max-width: 768px) {\n    width: 20rem;\n    height: 11rem;\n    padding: 20px;   \n  }\n`;\n\nclass HeadingMenu extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            isOpen: false,\n            opacity: 0,\n            language: props.language,\n            sound: props.sound,\n        };\n        this.toggleModal = this.toggleModal.bind(this);\n        this.toggleSound = this.toggleSound.bind(this);\n        this.afterOpen = this.afterOpen.bind(this);\n        this.beforeClose = this.beforeClose.bind(this);\n        this.onSelectChanged = this.onSelectChanged.bind(this);\n    }\n\n    onSelectChanged(e) {\n        let language = options.find(y => y.text === e.value)\n        this.setState({ language: language })\n        this.props.onChange(language);\n    }\n    toggleModal(e) {\n        this.setState({ isOpen: !this.state.isOpen });\n    }\n\n    toggleSound(e) {\n        this.setState({ sound: !this.state.sound });\n        this.props.onChange()\n\n    }\n    afterOpen() {\n        setTimeout(() => {\n            this.setState({ opacity: 1 });\n        });\n    }\n\n    beforeClose() {\n        return new Promise(resolve => {\n            this.setState({ opacity: 0 });\n            setTimeout(resolve, 200);\n        });\n    }\n\n    render() {\n        return (\n            <div className={this.props.className}>\n                <StyledModal\n                    isOpen={this.state.isOpen}\n                    afterOpen={this.afterOpen}\n                    beforeClose={this.beforeClose}\n                    onBackgroundClick={this.toggleModal}\n                    onEscapeKeydown={this.toggleModal}\n                    opacity={this.state.opacity}\n                    backgroundProps={{ opacity: this.state.opacity }}>\n                    <strong> Settings </strong> <br />\n                    {this.state.sound ? <span style={{ cursor: \"pointer\" }} onClick={this.toggleSound} role=\"img\" aria-label=\"soundOn\"> Toggle sound ðŸ”Š</span> : <span style={{ cursor: \"pointer\" }} onClick={this.toggleSound} role=\"img\" aria-label=\"soundOff\"> Toggle sound ðŸ”‡</span>}\n                    <section>Language:</section>\n                    <Dropdown  role=\"img\" value={this.state.language.text} options={options.map(y => y.text)} onChange={this.onSelectChanged} />\n                </StyledModal>\n                <h1 className=\"customTitle\" onClick={this.toggleModal}>Dagopedia </h1>\n            </div>\n        );\n    }\n}\nexport default HeadingMenu;","import 'leaflet/dist/leaflet.css';\nimport './index.scss'\n\nimport { Map, Marker, Popup, TileLayer } from 'react-leaflet';\nimport React, { Component, createRef } from 'react';\n\nimport HeadingMenu from './containers/headingMenu'\nimport L from 'leaflet';\nimport { ModalProvider } from 'styled-react-modal'\nimport ReactDOM from 'react-dom';\nimport iconMarker from './marker-filled.png'\nimport wikiLogo from './WikipediaLogo.svg'\n\n// Todo:\n//\n// Back button:         remove current in visitedPage and\n// Custom position:     Trigger by holding map, disable watchPosition and take position from marker, add button\n//\n//  Article:            Load all elements and pictures\n//\nconst defaultLocation = {\n    lat: 59.3264264,\n    lng: 18.0707082\n}\nlet markerIcon = L.icon({\n    iconUrl: iconMarker,\n    iconSize: [40, 40],\n    iconAnchor: [12.5, 41],\n    popupAnchor: [8, -41]\n})\n\nclass App extends Component {\n    constructor(props) {\n        super(props);\n        this.mapRef = createRef();\n        this.state = {\n            position: defaultLocation,\n            marker: defaultLocation,\n            zoom: 1.5,\n            started: false,\n            haveUserPosition: false,\n            sound: false,\n            language: { code: \"sv\", text: 'Svenska ðŸ‡¸ðŸ‡ª', speachCode: 'Swedish Female', startText: \"Starta\" },\n            visitedPageIds: [],\n            wikiText: \"\",\n            url: \"\"\n\n        };\n        this.wikiFetch = this.wikiFetch.bind(this);\n        this.goBack = this.goBack.bind(this);\n    }\n    componentDidMount() {\n        this.updatePosition();\n    }\n\n    updatePosition() {\n        navigator.geolocation.watchPosition(position => {\n            this.setState({\n                position: {\n                    lat: position.coords.latitude,\n                    lng: position.coords.longitude\n                }\n                , haveUserPosition: true,\n            }\n            )\n        }\n        )\n    }\n    onChange(e) {\n        if (e) {\n            this.setState({ language: e, visitedPageIds: [] });\n        } else {\n            if (this.state.sound) {\n                window.responsiveVoice.cancel();\n            }\n            this.setState({ sound: !this.state.sound });\n        }\n    }\n    updateMarker = (data) => {\n        const mapComp = this.mapRef.current;\n        this.setState({ marker: { lat: data.lat, lng: data.lon, header: data.title } })\n        let wikiURL = \"https://\" + this.state.language.code + \".wikipedia.org/w/api.php?action=query&format=json&prop=info%7Cextracts&inprop=url&exintro=1&explaintext=1&origin=*&pageids=\" + data.pageid;\n        mapComp.leafletElement.flyToBounds([\n            [this.state.position.lat, this.state.position.lng],\n            [data.lat, data.lon]\n        ], {\n            padding: [60, 60],\n            animate: true, duration: 0.70\n        }\n        );\n        fetch(wikiURL)\n            .then(response => response.json())\n            .then(datas => {\n                if (this.state.sound) {\n                    window.responsiveVoice.speak(datas.query.pages[data.pageid].extract, this.state.language.speachCode);\n\n                }\n                this.setState({ wikiText: datas.query.pages[data.pageid].extract, url: datas.query.pages[data.pageid].fullurl })\n            });\n    }\n    wikiFetch() {\n        let limitString = \"&gslimit=\" + (this.state.visitedPageIds.length + 1);\n        this.setState({ started: true });\n        let coordStrig = \"&gscoord=\" + this.state.position.lat + \"|\" + this.state.position.lng;\n        let URL = \"https://\" + this.state.language.code + \".wikipedia.org/w/api.php?action=query&prop=&list=geosearch&gsradius=10000&format=json&origin=*\"\n        URL = URL + coordStrig + limitString;\n        fetch(URL)\n            .then(response => response.json())\n            .then(data => {\n                let visitedIndexes = [];\n                for (let i = 0; i < data.query.geosearch.length; i++) {\n                    for (let j = 0; j < this.state.visitedPageIds.length; j++) {\n                        if (data.query.geosearch[i].pageid === this.state.visitedPageIds[j].pageid) {\n                            visitedIndexes.push(i)\n                        }\n                    }\n                }\n                let closesPage = 0;\n                for (let i = 0; i < visitedIndexes.length + 1; i++) {\n                    if (!visitedIndexes.includes(i)) {\n                        closesPage = i;\n                        break;\n                    }\n                }\n                if (data.query.geosearch[closesPage] === undefined) {\n                    return\n                }\n                this.setState({\n                    visitedPageIds: [...this.state.visitedPageIds, data.query.geosearch[closesPage]]\n                });\n                this.updateMarker(data.query.geosearch[closesPage]);\n            }\n            )\n    }\n    goBack() {\n        if (this.state.visitedPageIds.length <= 1) {\n            return\n        }\n        let tempAry = this.state.visitedPageIds.slice(0, -1);\n\n        this.setState({\n            visitedPageIds: tempAry\n        })\n        this.updateMarker(tempAry[tempAry.length - 1])\n    }\n\n\n\n    render() {\n        const position = [this.state.position.lat, this.state.position.lng]\n        return (\n            <div className=\"pageWrapper\">\n                <ModalProvider>\n                    <HeadingMenu sound={this.state.sound} language={this.state.language}\n                        onChange={this.onChange.bind(this)} ref={this.mapRef} />\n                </ModalProvider>\n                {this.state.started ? this.state.haveUserPosition ? \"\" : <div className=\"locationUnavailableTex\"> location unavailable, using default marker </div> : \"\"}\n                <Map\n                    ref={this.mapRef}\n                    className='map'\n                    center={[23.520007, 13.404954]}\n                    zoom={this.state.zoom}\n                    zoomControl={false}\n                    minZoom={1.5}\n                    maxZoom={18}\n                    zoomSnap={0.1}\n                    id={'your.mapbox.project.id'}\n                    accessToken={'your.mapbox.public.access.token'}>\n                    <TileLayer id='mapbox.streets'\n                        url='https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'\n                    />\n                    {this.state.started ? <Marker position={position} icon={markerIcon}>\n                        <Popup>\n                            <span>You are here</span>\n                        </Popup>\n                    </Marker> : \"\"}\n                    {this.state.started ?\n                        <Marker opacity={0.5} icon={markerIcon} position={[this.state.marker.lat, this.state.marker.lng]}>\n                            <Popup>\n                                <span>{this.state.marker.header}</span>\n                            </Popup> </Marker> : \"\"}\n                </Map>\n\n                {\n                    this.state.started ?\n                        <div>\n                            <div className=\"wikiTitleContainer\">\n                                <div href=\"#\" className=\"previous\" onClick={this.goBack}>â†¤ </div>\n                                <h1 className=\"wikiTitle\">\n                                    {this.state.marker.header}\n                                </h1>\n\n                                <div href=\"#\" className=\"next\" onClick={this.wikiFetch}>â†¦</div>\n                            </div>\n                            <section style={{ textAlign: \"left\", paddingBottom: \"1rem\", marginTop: \"0.5rem\" }}>{this.state.wikiText}</section>\n                            {this.state.wikiText && <a className=\"wikiLink\" rel=\"noopener noreferrer\" target=\"_blank\" href={this.state.url}>  <img style={{ width: \"3rem\", height: \"3rem\" }} src={wikiLogo} alt=\"Logo\" /></a>}\n                        </div>\n                        :\n                        <div className=\"item button-hand buttonWrapper\" >\n                            <button onClick={this.wikiFetch}>\n                                {this.state.language.startText}\n                                <div className=\"hands\"></div>\n                            </button>\n                        </div>\n                }\n\n            </div>\n        );\n    }\n}\nReactDOM.render(<App />, document.getElementById('root'));"],"sourceRoot":""}